2021.12.14

P93-P 

36.开发trade模块
最后提交订单 也会提交一些参数
比如选择的地址 让它变为计算属性 自动改变 方便

36.1.获取用户地址信息
写axios vuex
无参数 但是响应头有token 因此登录了才能获取地址信息
选择使用排他算法

36.2.获取订单交易页信息
获取数据,展示数据

36.3.提交订单
静态组件 路由
携带写好的参数 向服务器提交 即axios
这里我们故意不用vuex 该怎么做?
请求接口 写在点击的回调函数里就行了
得到的数据可以直接在回调函数里得到

36.4.导入模块
可以在main文件将模块赋值到vue原型上,这样组件不用导入也可以使用


37.开发pay模块
37.1.
根据trade模块传来的订单号orderId,作为参数访问接口,得到信息
以前我们在mounted里dispatch
现在直接写访问接口并且存数据

37.2.弹出二维码支付框
使用element设置弹框
用定时器每隔一段时间,使用查询订单状态的接口,接口会返回promise
若成功则清除定时器,保存code(如果成功,code应该是200),路由跳转到支付成功页面

在element里设置用户点击"支付成功/失败"的回调函数
2021.12.10

P74-P80

[重要]33.开发ShopCart组件
静态页面路由
写axios
vuex
绑定数据展示页面

33.1.生成uuid
写一个函数
每次访问都生成唯一不变的uuid
方法是,查看本地存储有无UUID,有就不生成,没有就生成UUID并存在本地
然后在details的仓库调用这个函数,在details的state里拿到uuid
加载details时 获取uuid

33.2.使用uuid
添加购物车,获取购物车需要一个身份uuid,需要传一个参数到服务器,但是不能在axios参数里传,怎么办
在请求拦截器中,如果details的state存在uuid
则设置config的请求头带参 参数为uuid

33.3.vuex
发送axios请求.获取shopcart数据
shopcart的axios请求不带参数 因为响应头有参数uuid

33.4.展示数据
复杂的展示数据在计算属性中进行

33.5.全选按钮
其中 是否全选 这个功能
一开始我想 获得所有元素节点
但是这是在vue里面 节点都是响应式的
就是说 每个单选框的value都绑定了一个isChecked
那么只需要关心数据就可以了 不用去获得节点
改变数据 节点自然会改变

(1)
给全选绑定事件 
同33.9

(2)
绑定单选按钮事件
点击 发送axios 告诉要改变的id和状态 让服务器修改数据
再获取购物车信息
(3)
单选按钮改变全选按钮状态
写一个计算属性
若单选按钮全为1则它为1 否则为0
让全选按钮的checked绑定这个计算属性

技巧:click事件传递p很好用

33.6.商品数量的改变
可以使用请求购物成功的数据的接口
和details组件的加入购物车一样
发送dispatch调用vuex的actions的shoppingCart,告诉服务器修改参数

让- + input框三者绑定同一个函数
通过传参来区分是谁触发了函数

问题:为什么点击+ 数量没更新?
点击+,调用this.$store.dispatch('shoppingCart',{id:,num:})向服务器发送请求
服务器修改参数(注意!!!!!!这个axios请求是不返回数据的)
请求数据是this.$store.dispatch("getShopCart"),在mounted写的
请求服务器数据只执行一次 因此页面数据不会改变
所以 当触发修改商品数量函数后
再发一次 this.$store.dispatch("getShopCart")获取数据
只有改变组件自身带的数据 页面才会立即改变
!组件的数据也是经过vuex发送axios得到服务器的数据 然后绑定到组件上的
因此不发送dispatch获取数据 组件的数据就不会和服务器同步


33.7.删除购物车商品
发送数据到接口,这个接口没有返回信息
写axios
vuex
重新获取购物车信息

33.8.优化商品数量的改变
问题:点击-过快 导致数量变为负数
需要节流

